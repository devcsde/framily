{"version":3,"sources":["../../../app/routes/index.js"],"names":["express","require","passport","router","Router","h","config","get","req","res","next","render","title","isAuthenticated","host","user","getRoom","findRoomById","app","locals","chatrooms","params","id","undefined","room","roomID","logout","redirect","authenticate","failureRedirect","scope","all","module","exports"],"mappings":"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","file":"index.js","sourcesContent":["const express = require('express');\nconst passport = require(\"passport\");\nconst router = express.Router();\nconst h = require('../helpers');\nconst config = require(\"../config\");\n\n//////////////\n// GET ROUTES\nrouter.get('/', (req, res, next) => {\n    res.render('login', {\n        title: \"Fr'amily | Login\"\n    })\n});\n\nrouter.get('/rooms', h.isAuthenticated, (req, res, next) => {\n    res.render('rooms', {\n        title: \"Fr'amily | Rooms\",\n        host: config.host,\n        user: req.user\n    })\n});\n\nrouter.get('/chat/:id', h.isAuthenticated, (req, res, next) => {\n    // find a chatroom with given id\n    // render if the id is found\n    let getRoom = h.findRoomById(req.app.locals.chatrooms, req.params.id);\n    if(getRoom === undefined) {\n        return next();\n    } else {\n        res.render('chatroom', {\n            title: \"Fr'amily | Chat\",\n            host: config.host,\n            user: req.user,\n            room: getRoom.room,\n            roomID: getRoom.roomID\n        });\n    }\n});\n\nrouter.get('/logout', async (req, res, next) => {\n    await req.logout();\n    res.redirect('/');\n});\n\nrouter.get('/auth/facebook',\n    passport.authenticate('facebook'));\n\nrouter.get('/auth/facebook/callback',\n    passport.authenticate('facebook', {failureRedirect: '/login'}),\n    function (req, res) {\n        // Successful authentication, redirect home.\n        res.redirect('/rooms');\n    });\n\nrouter.get('/auth/google',\n    passport.authenticate('google', {scope: 'https://www.googleapis.com/auth/plus.login'}));\n\nrouter.get('/auth/google/callback',\n    passport.authenticate('google', {failureRedirect: '/login'}),\n    function (req, res) {\n        res.redirect('/rooms');\n    });\n\nrouter.get('/auth/twitter',\n    passport.authenticate('twitter'));\n\nrouter.get('/auth/twitter/callback',\n    passport.authenticate('twitter', {failureRedirect: '/login'}),\n    function (req, res) {\n        res.redirect('/rooms');\n    });\n\n///////////////\n// POST ROUTES\n\n\n//////////////////////////////////////////\n// CATCH ALL ROUTES WHICH ARE NOT DEFINED\nrouter.all('*', h.isAuthenticated, async (req, res, next) => {\n    await res.render('404', {\n        title: \"Fr'amily | Not Found\"\n    })\n});\n\nmodule.exports = router;\n"]}